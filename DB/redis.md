## Redis란 ?

Remote Dictionary Server 라는 뜻으로 외부에 key-value 를 저장하는 서버를 말한다. Redis는 주로 **인메모리 데이터 구조 저장소**로, 데이터베이스, 캐시, 메시지 브로커로 사용된다.

### 인메모리 ?

인메모리는 컴퓨터의 메인 메모리 RAM 에 데이터를 올려서 사용하는 방법이다. 메모리에 데이터를 올리면 SSD, HDD 같은 저장 공간에서 데이터를 가져오는 것보다 훨씬 빠르다는 이점이 있다. 따라서 인메모리 데이터 구조 저장소를 사용하는 Redis는 빠른 속도가 큰 장점이다. 

반면, 메모리는 SSD, HDD에 비해 용량이 크지 않고 Redis 또한 용량이 작다는 치명적인 단점이 있다. Redis가 다양한 형태의 데이터 구조를 지원하기만 복잡한 데이터를 저장하는 데이터베이스로 사용하기는 어렵다. 보통 Redis는 캐시 서버로 많이 사용한다.

그런데 메모리는 휘발성이라고 배웠다. Redis에 있는 데이터도 서버가 꺼지면 사라지는 것일까? Redis가 **데이터의 안전성**을 어떻게 보장하는지 알아보자.

## Redis 데이터의 영속성(persistence)

Redis는 메모리 데이터를 disk에 저장할 수 있다.

그래서 서버가 꺼진 후 restart되어도 disk에 저장해놓은 데이터를 다시 읽어 메모리에 로딩하기 때문에 데이터가 유실되지 않는다.

Redis는 RDB(snaphostting) 방식과 AOF(Append Only File) 방식을 사용해 데이터를 저장한다.

### RDB 방식

> 특정 간격마다 메모리에 있는 레디스 데이터 전체를 디스크에 쓰는 것이다.

주기적으로 파일에 데이터를 저장하는데, Redis 프로세스가 장애로 인해 종료되더라도 해당 파일을 읽어들이면 이전의 상태를 동일하게 복구할 수 있다.

Redis는 자동으로 **.rdb**라는 확장자의 파일에 인메모리 데이터를 저장하도록 디폴트 설정 되어 있다. AOF 파일보다 사이즈가 작아 로딩 속도가 빠르다는 장점이 있다.

### AOF 방식

> 명령이 실행될때마다 데이터를 파일에 기록하여 데이터의 손실이 거의 없다.

레디스의 모든 write / update 연산 자체를 모두 log 파일에 기록한다. default로 **appendonly.aof** 파일에 기록되며, 조회를 제외한 입력/수정/삭제 명령이 실행될 때마다 기록된다.


* 참고
    * https://zangzangs.tistory.com/72 
    * https://inpa.tistory.com/entry/REDIS-%F0%9F%93%9A-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EC%98%81%EA%B5%AC-%EC%A0%80%EC%9E%A5%ED%95%98%EB%8A%94-%EB%B0%A9%EB%B2%95-%EB%8D%B0%EC%9D%B4%ED%84%B0%EC%9D%98-%EC%98%81%EC%86%8D%EC%84%B1
    * https://souljit2.tistory.com/72
